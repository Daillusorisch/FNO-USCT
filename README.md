# FNO-USTC

An FNO based model builded for speed ​​reconstruction in ultrasound CT imaging.

## Model

```mermaid
graph LR
    A[Input] --> B{Preprocessing}
    B --> |envelope & phase| C[entry1]
    E[position embedding1] --> C[entry1]
    B --> |high frequence & phase| D[entry2]
    F[position embedding2] --> D[entry2]
    C --> G(Mix)
    D --> G
    G --> H[FNO Layer]
    H --> |...|I[Output]

```

## Data

The data used for training is generated by DP, which can be obtained in [this competition](https://bohrium.dp.tech/competitions/2522351329) and their upcoming papers.

Download the data and put it in the `data` folder.

## Training

First, set up the conifguration in `config.toml`.

Then, run the following command to train the model.

```bash
python train.py
```

The training process will be saved in the `runs` folder and can be monitoring using tensorboard.

Checkpoints will be saved in the `checkpoints` folder.

## Inference

```bash
python inference.py -m <model_path> -i <data_path>
```

## License

MIT
